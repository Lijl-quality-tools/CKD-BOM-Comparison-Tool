## CKD清单核对工具 - 面试/作品集讲解指南

### 1. 一句话介绍

- **中文**：这是一个面向制造业场景的 CKD 清单核对工具，可以自动对比 BOM 与多份物料清单，识别缺料、数量差异和替代料使用情况，并输出 Excel 报告。
- **英文（可选）**：A CKD checklist reconciliation tool that automatically compares BOM against multiple material lists, detects discrepancies and substitutes usage, and generates Excel reports.

---

### 2. 背景与业务痛点（可以这样讲）

- 传统做法：BOM 与清单核对主要依赖人工用 Excel 进行 VLOOKUP、筛选和人工比数，**效率低、易出错**。
- 典型痛点：
  - 多条生产线、多工序、多供应商清单，人工切换文件非常繁琐。
  - 涉及替代料时，人工很难快速看出“主料 + 所有替代料”是否满足需求。
  - 加密 Excel（如绿盾）与服务器环境不兼容，普通脚本无法直接读取。
- 本项目的目标：
  - 把这套流程做成 **一键化、标准化** 的 Web 工具，降低一线人员操作门槛。

---

### 3. 技术方案亮点（可以重点强调）

- **Smart Anchor 智能表头定位**
  - 不要求用户在模板里固定列名与列顺序。
  - 程序在前 N 行自动扫描并根据关键词打分，推断“料号/数量/箱号”等字段所在列。
  - 用户只需在下拉框中确认，极大降低使用成本。

- **多清单并行核对**
  - 一次上传多份清单，每份清单各自有独立的列映射与核对结果。
  - 汇总 Sheet 列出各清单通过率与异常统计，方便管理人员整体评估。

- **替代料深度融合**
  - 在 BOM 侧维护主料与替代料关系。
  - 清单侧把主料与所有替代料数量进行合并后再对比，符合实际生产场景。

- **解密服务器架构**
  - 使用 `xlwings + Excel COM`，通过真正的 Excel 进程打开加密文件，保持与办公环境一致。
  - 结合 `threading.Lock`，保证同一时间只有一个解密会话，避免多线程冲突。
  - 所有临时文件在 `try...finally` 中删除，兼顾稳定性与安全性。

---

### 4. 工程化与代码设计（可以展示的点）

- 采用模块化结构：
  - `config` 集中管理常量和关键词配置。
  - `file_reader` 统一处理所有 Excel 读取与解密逻辑。
  - `ui_helper` 负责所有动态 UI 与智能列映射交互。
  - `data_processor` 专注于业务比对与报表生成。
- 使用 `pandas` 与 `xlsxwriter` 完成数据处理与报表输出，保留良好的扩展空间。
- 代码围绕“极简 UI + 强逻辑”设计，确保一线用户易用的同时，内部逻辑足够清晰可维护。

---

### 5. 可以量化/示例化的效果（回答“效果如何”）

- 将原本 **需要 1–2 小时** 的人工核对流程，压缩到 **几秒到几分钟**。
- 在大量替代料场景下，自动计算主料+替代料合计数量，减少人工漏算的风险。
- 输出的 Excel 报告可直接用于流转和留档，兼容现有办公流程。

> 如果你有真实使用数据，可以在这里补充如“每天核对 X 份清单、节约 Y 小时人力”等具体数字，会更打动面试官。

---

### 6. 可继续演进的方向（体现思考深度）

- 接入数据库与看板：沉淀历史核对记录，做月度/季度分析。
- 加入账号体系与权限：区分操作员、班组长、工艺工程师的可见内容。
- 使用 FastAPI/Django 等将比对逻辑服务化，Streamlit 退化为纯前端壳。
- 引入自动化测试与 CI，保障关键核对逻辑在版本迭代中的稳定性。